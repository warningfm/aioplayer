!function(e){"use strict";var t={duration:75,autoWidth:!1,btnText:'<i class="fa fa-caret-down"></i>',classes:{container:"selectbox",placeholderContainer:"current-value",placeholder:"placeholder",search_box:"search_string",btn:"droparrow",options:"options",selected:"selected",open:"opened"}};e.fn.selectbox=function(s){s=s||{};var a=e.extend(!0,{},t,s),n="",l=function(t){var s="",l=null,o={},r=function(){n="",t.next("."+a.classes.container).trigger("clear_search")},c=function(a){t.html()===s&&"ignore"!==a||(e.each(t.find("option"),function(){var t=e(this);t.text().length&&(o[e.trim(t.text())]=t.val())}),s=t.html())},i=function(){clearTimeout(l),l=setTimeout(r,1500)};return{find:function(s){var l,r=e(t.find("option").get(t.get(0).selectedIndex)),d=!1;return c(),i(),n+=s,l=n.length,t.next("."+a.classes.container).trigger("update_search",[n]),r.length&&r.text().substr(0,l).toUpperCase()===n||l&&e.each(o,function(e,t){if(e.substr(0,l).toUpperCase()===n)return d=t,!1}),d},clear:function(){clearTimeout(l),r()}}};return this.each(function(){var t,s,n,o,r,c,i,d,h=e(this),u=new l(h),g=this;h.is("select")&&(h.data("sl")===!0&&h.next("."+a.classes.container).remove(),t=h.find("option"),n=e("<div/>",{"class":a.classes.container,css:{}}),o=e("<div/>",{"class":a.classes.placeholderContainer,tabindex:0}),r=e("<div/>",{"class":a.classes.placeholder}),c=e("<div />",{"class":a.classes.btn,html:a.btnText,css:{}}),o.append(r,c),i=e("<ul/>",{"class":a.classes.options,css:{}}),s=e("<div />",{"class":a.classes.search_box}).hide(),t.each(function(){var t=e(this),s=e("<a/>",{href:"#",text:t.text(),"class":t.prop("disabled")?"disabled":"",css:{},click:function(e){return e.preventDefault(),!t.prop("disabled")&&(h.val()!==t.val()&&(null!=t.attr("data-html")?r.html(t.attr("data-html")):r.text(t.text()),i.find("a").removeClass(a.classes.selected),s.addClass(a.classes.selected),h.val(t.val()).trigger("change",[{sl:!0}])),i.slideUp(a.duration),n.removeClass(a.classes.open),void n.trigger("clear_search"))}}),l=e("<li/>");l.append(s),i.append(l),null!=t.attr("data-html")&&s.html(t.attr("data-html")),null!=h.attr("data-value")&&""!=h.attr("data-value")&&(h.val(h.attr("data-value")),h.trigger("change"))}),o.on("click",function(t){t.preventDefault(),i.slideToggle(a.duration,function(){n.toggleClass(a.classes.open),h.trigger("recalculate"),n.trigger("calibrate_search");var t=o.outerHeight()+i.outerHeight(),s=e(window).scrollTop()+e(window).height()-o.offset().top;t>s?i.css({top:"auto",bottom:o.outerHeight()}):i.css({bottom:"auto",top:o.outerHeight()})})}),o.on("keydown",function(e){var s,a=e.charCode||e.keyCode,n=String.fromCharCode(a),l=!1,c=g.selectedIndex;return 40!==a&&39!==a||(l=!0,g.selectedIndex=Math.min(t.length-1,g.selectedIndex+1)),38!==a&&37!==a||(l=!0,g.selectedIndex=Math.max(0,g.selectedIndex-1)),13!==a&&32!==a||(o.trigger("click"),l=!0),8!=a&&46!=a||(u.clear(),l=!0),l?(e.preventDefault(),c!==g.selectedIndex&&(u.clear(),h.trigger("change")),!1):void(/[a-zA-Z0-9-_ !@#$%^&*\(\)+\/\\?><;:'"|]/.test(n)&&(s=u.find(n,r),u.search_obj=r,s&&h.val(s).trigger("change")))}),o.on("selectstart",function(){return!1}),e(document).on("mouseup",function(e){n.has(e.target).length||(i.slideUp(a.duration),n.trigger("clear_search"),n.removeClass(a.classes.open))}),h.on("recalculate",function(){var t=this.selectedIndex,s=Math.abs(i.scrollTop()),l=e(d.get(t)),o=parseInt(l.outerHeight(),10),r=l.offset().top-d.first().offset().top;r<s?i.clearQueue().animate({scrollTop:o+r-n.outerHeight()},a.duration):r>s+i.height()-l.outerHeight()&&i.clearQueue().animate({scrollTop:o+r-i.height()+l.outerHeight()-n.outerHeight()},a.duration)}),h.on("change",function(){var s=this.selectedIndex,n=e(d.get(s));e(this).trigger("recalculate"),null==e(t.get(s)).attr("data-html")?r.text(e(t.get(s)).text()):r.html(e(t.get(s)).attr("data-html")),d.removeClass(a.classes.selected),n.addClass(a.classes.selected)}),d=i.find("a"),null==e(t.get(h[0].selectedIndex)).attr("data-html")?r.text(e(t.get(h[0].selectedIndex)).text()):r.html(e(t.get(h[0].selectedIndex)).attr("data-html")),e(d.get(h[0].selectedIndex)).addClass(a.classes.selected),a.autoWidth&&r.width(h.width()),n.append(o,i),h.hide().after(n).data("sl",!0),i.hide().css("top",n.outerHeight()),n.on("clear_search",function(){s.empty().hide()}),n.on("update_search",function(e,t){s.show().text(t)}),n.on("calibrate_search",function(){n.hasClass(a.classes.open)?s.css({top:i.outerHeight()+n.outerHeight()-20,right:0}):s.css({top:"auto",right:0}).hide()}),n.append(s))}),this}}(jQuery);