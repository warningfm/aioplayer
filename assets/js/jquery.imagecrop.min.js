!function(t){t.fn.imagearea=function(e,i){t(this).unbind("mousemove"),t(this).unbind("mousedown"),t(this).unbind("mouseup"),defaults={width:140,height:140};var i=t.extend(defaults,i),h=t('<img src="'+e+'" style="cursor: move;">');t(this).html(h).css({width:i.width,height:i.height}),h.width()/(h.height()/i.height)>i.width?h.attr({width:"auto",height:i.height}):h.attr({height:"auto",width:i.width});var e={width:h.width(),height:h.height()},o=!1,n=0,a=0,s=0,f=0,u=t(this),d=t('[name="cropX"]'),r=t('[name="cropY"]'),c={left:e.width-i.width,top:e.height-i.height};t(u).on("mousedown",function(t){a=s+(u.offset().left+t.pageX),n=f+(u.offset().top+t.pageY),t.originalEvent.preventDefault(),o=!0}),t(document).on("mousemove",function(e){if(o){var i=a-(u.offset().left+e.pageX),h=n-(u.offset().top+e.pageY);i<=c.left&&i>=0&&(t(u).find("img").css("left",i*-1),s=i),h<=c.top&&h>=0&&(t(u).find("img").css("top",h*-1),f=h),d.val(s),r.val(f)}}),t(document).on("mouseup",function(){o&&(t(u).unbind("mousemove"),o=!1)}),t(document).on("keydown",function(e){switch(e.which){case 37:var i=s-1;break;case 39:var i=s+1;break;case 38:var h=f-1;break;case 40:var h=f+1;break;default:return}i<=c.left&&i>=0&&(t(u).find("img").css("left",i*-1),s=i),h<=c.top&&h>=0&&(t(u).find("img").css("top",h*-1),f=h),r.val(f),d.val(s),e.preventDefault()})}}(jQuery);